---
title: Usage
description: 'Access text, images, and other media with Nuxt and the Sanity headless CMS.'
---

You can access Sanity throught your application with the globally available `useSanity()` composable. The returned object is cached, so you can use it in your components.

:::alert{type="info"}
If you want to access this helper globally through `$sanity` as it used to be, just add the following plugin:

```js
export default defineNuxtPlugin(() => {
  return {
    provide: {
      sanity: useSanity()
    }
  }
})
```
:::


## Reference

### `fetch`

This enables you to perform a GROQ query against your Sanity dataset. By default it returns a `Promise<unknown>` although you can customise the type of the return.

#### Example with `asyncData`

:::::code-group
::::code-block{label="JavaScript" active}

```html
<script setup>
const query = groq`{ "articles": *[_type == "article"] }`

const sanity = useSanity()

const { data } = await useAsyncData('articles', () => sanity.fetch(query))
</script>
```

::::
::::code-block{label="TypeScript"}

```html
<script setup lang="ts">
const query = groq`{ "articles": *[_type == "article"] }`

const sanity = useSanity()

// By default it returns a `Promise<unknown>`,
// but you can customise the type of the return.
const { data } = await useAsyncData('articles', () => sanity.fetch<{ articles: Article[] }>(query))
</script>
```

::::
:::::

### `client`

You can access the underlying client with this property. This is most useful if not using the minimal client.

```ts
const query = groq`*[_type == "article"][0].title`

export default defineComponent({
  setup() {
    const sanity = useSanity()
    onMounted(() => {
      const observable = sanity.client.listen(query)
      observable.subscribe(event => {
        // Do something
      })
    })
  },
})
```

### `setToken`

You can securely set the token for your Sanity client in a Nuxt plugin.

```js{}[plugins/sanity.server.ts]
export default defineNuxtPlugin((nuxtApp) => {
  const sanity = useSanity()
  const token = getTokenFromReq(nuxtApp.ssrContext.req)
  sanity.setToken(token)
})
```

### `config`

You can access the Sanity config you have passed into the module if you need to do so (for example, with `@sanity/image-url`):

```js{}[plugins/sanity.ts]
import imageUrlBuilder from '@sanity/image-url'
export default defineNuxtPlugin(() => {
  const sanity = useSanity()
  const builder = imageUrlBuilder(sanity.config)

  function urlFor(source) {
    return builder.image(source)
  }

  return {
    provide: { urlFor }
  }
})
```

### Additional clients

If you have [configured additional clients](/getting-started/configuration#additionalclients) you can access them by passing in a client name to `useSanity`. It returns a sanity helper, with all the same properties and methods as specified above. So, for example:

```js{}[plugins/fetch.ts]
export default defineNuxtPlugin(() => {
  const otherSanityHelper = useSanity('other')
  otherSanityHelper.fetch('*[type == "article"][0]')
})
```
